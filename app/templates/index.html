{% extends "base.html" %}


{% block content %}

<div class="container-fluid align-center">
    <div class="instructions col-lg-10 col-lg-offset-2">
        <p>
            Click on the artist you think is currently the most popular on Spotify!

        </p>
    </div>
</div>


<div class="container-fluid align-center">
    <div class="row">
        <div class="thumb col-lg-4 col-lg-offset-2">

            <img src="{{artists['a1'].image}}" class="artistImage" onclick="checkChoice('a1')">
            <div id="a1_overlay" class="hidden" onclick="checkChoice('a1')"></div>


        </div>


        <div class="thumb col-lg-4 col-lg-offset-1">

            <img src="{{artists['a2'].image}}" class="artistImage" onclick="checkChoice('a2')">
            <div id="a2_overlay" class="hidden" onclick="checkChoice('a2')"></div>

        </div>


    </div>
    <div class="row">
        <div class="col-lg-4 col-lg-offset-2">
            <p class="artistName">{{artists['a1'].name}}</p>
        </div>

        <div class="col-lg-4 col-lg-offset-1">
            <p class="artistName">{{artists['a2'].name}}</p>
        </div>

    </div>
</div>

<div class="container-fluid align-center">
    <div class="instructions col-lg-6 col-lg-offset-2">
        <p>
            {{matchup_text}}
        </p>
    </div>
</div>

<script>


    function applyOverlay(choice) {

        if (choice == "{{correct}}") {
            var color = "green"
        }
        else {
            color = "red"
        }

        var deferred = $.Deferred();
        $('#' + choice + '_overlay').removeClass("hidden")

        $('#' + choice + '_overlay').css({'background-color': color})

        deferred.resolve();

        return deferred.promise(choice);
    }


    function checkChoice(choice) {


        applyOverlay(choice).then(function () {

            console.log('choice is')

            console.log(choice)


            if ("{{correct}}" == "a1") {

                var correct_name = "{{artists['a1'].name}}";
                var incorrect_name = "{{artists['a2'].name}}"

            }

            else {

                correct_name = "{{artists['a2'].name}}";
                incorrect_name = "{{artists['a1'].name}}"

            }

            var correctString = correct_name + ' is more popular than ' + incorrect_name


            if (choice == "{{correct}}") {

                alert('Correct! ' + correctString);


                location.href = Flask.url_for('index', {});

            }

            else {

                alert('Incorrect! ' + correctString)
                location.href = Flask.url_for('index', {});
            }



        })
    }

</script>


{% endblock %}